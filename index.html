<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Engagement Card â€” Taylor & Travis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root{
      --bg:#0f1015; --ink:#ffffff; --muted:#cfd2da; --radius:22px;
      --chiefs-grad:linear-gradient(90deg,#E31837 0%,#FFD166 100%);
      --showgirl-grad:linear-gradient(90deg,#FFB457 0%,#FFD166 50%,#FFA040 100%);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;margin:0;padding:0}
    body{color:var(--ink);background:var(--bg);font-family:ui-serif,Georgia,"Times New Roman",system-ui;display:grid;place-items:center;padding:24px;}
    .card{position:relative;width:min(860px,95vw);border-radius:var(--radius);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.12);box-shadow:0 10px 50px rgba(0,0,0,.55),inset 0 0 0 1px rgba(255,255,255,.05),inset 0 0 30px rgba(255,209,102,.08);overflow:hidden;}
    .hero{position:relative;aspect-ratio:16/9;overflow:hidden;cursor:pointer;display:block;}
    .hero.glow-on #bridgeGlow{opacity:.28}
    .hero.glow-on #innerGlow{opacity:.30}
    .hero.glow-on #archGlow{opacity:.18}
    .hero #bridgeGlow,.hero #innerGlow,.hero #archGlow{transition:opacity .35s ease}
    #backGlow,#archGlow,#bridgeGlow,#innerGlow,#sparkle,#frontHaze{position:absolute;inset:0;display:block;pointer-events:none;}
    #backGlow{z-index:1;mix-blend-mode:screen;}
    #archGlow{z-index:2;mix-blend-mode:screen;}
    #bridgeGlow{z-index:2;mix-blend-mode:screen;}
    #innerGlow{z-index:2;mix-blend-mode:screen;}
    .hero img{position:relative;z-index:4;width:100%;height:100%;object-fit:cover;display:block;filter:saturate(1.05) contrast(1.03);}
    .hero::after{content:"";position:absolute;inset:0;z-index:5;background:radial-gradient(120% 80% at 50% 18%,transparent 48%,rgba(0,0,0,.32)72%,rgba(0,0,0,.56)100%);}
    #sparkle{z-index:6;}
    #frontHaze{z-index:7;opacity:.05;mix-blend-mode:overlay;background:radial-gradient(120% 90% at 50% 60%,rgba(255,255,255,.12),transparent 60%);}
    .pad{text-align:center;padding:clamp(18px,4vw,36px);}
    .badge{display:inline-block;padding:.5rem 1rem;border-radius:999px;background:#ffd166;color:#0b0b0f;font-weight:800;letter-spacing:.2px;box-shadow:0 8px 22px rgba(0,0,0,.35);}
    h1{margin:.75rem 0 0;font-size:clamp(2.4rem,3.2vw+1rem,3.8rem);line-height:1.05;font-weight:900;letter-spacing:.3px;color:#fff;text-shadow:0 2px 18px rgba(0,0,0,.45);transition:all .4s ease;--glow-intensity: 0;}
    h1.glowing{text-shadow:0 2px 18px rgba(0,0,0,.45),0 0 20px rgba(255,209,102,calc(var(--glow-intensity) * 0.3)),0 0 40px rgba(255,209,102,calc(var(--glow-intensity) * 0.2)),0 0 60px rgba(255,209,102,calc(var(--glow-intensity) * 0.1));}
    .sub{margin:.4rem 0 0;color:var(--muted);font-size:1.08rem;font-style:italic;opacity:.95;}
    .copy{margin:1.1rem auto 0;max-width:62ch;font-size:1.22rem;font-weight:500;}
    .chiefs{background:linear-gradient(90deg,#FFD166 0%,#FFD166 40%,#E31837 60%,#E31837 100%);background-size:200% 100%;background-position:0% 50%;-webkit-background-clip:text;background-clip:text;color:transparent;animation:flow 8s linear infinite;}
    .showgirl{background:var(--showgirl-grad);background-size:220% 100%;background-position:0% 50%;-webkit-background-clip:text;background-clip:text;color:transparent;animation:flow 10s linear infinite;}
    @keyframes flow{to{background-position:100% 50%;}}
    .lyric{display:block;margin:0;padding:1rem;font-family:'Segoe Script','Bradley Hand','Comic Sans MS',cursive;font-size:1rem;color:#ffd166;text-align:center;letter-spacing:.2px;text-shadow:0 1px 6px rgba(0,0,0,.55);background:rgba(255,255,255,.02);border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1);overflow:hidden;word-wrap:normal;white-space:nowrap;opacity:0;transition:opacity 0.3s ease;}
    .lyric.show{opacity:1;}
    .cta{margin-top:1.4rem;display:flex;justify-content:center;gap:12px;}
    .btn{appearance:none;border:0;cursor:pointer;padding:12px 18px;border-radius:12px;font-weight:800;color:#0b0b0f;letter-spacing:.2px;background:linear-gradient(135deg,#E31837,#FFD166);box-shadow:0 12px 32px rgba(0,0,0,.35);transition:transform .07s ease,filter .2s ease;}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.06);}
    .count{align-self:center;margin-left:12px;padding:8px 10px;border-radius:10px;background:rgba(255,255,255,.08);color:#ffd166;font-weight:700;letter-spacing:.2px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.12);}
    .wishes-intro{color:var(--muted);font-size:1rem;margin:1rem 0;font-style:italic;text-align:center;}
    footer{text-align:center;color:var(--muted);font-size:.92rem;margin-top:1.2rem;padding-bottom:.6rem;}
  </style>
</head>
<body>
  <main class="card" role="main">
    <div class="hero" id="heroBox">
      <div id="backGlow"></div>
      <div id="archGlow"></div>
      <div id="bridgeGlow"></div>
      <div id="innerGlow"></div>
      <img src="https://placeholder-for-engagement-photo.jpg" alt="Taylor Swift and Travis Kelce engagement photo"/>
      <canvas id="sparkle"></canvas>
      <div id="frontHaze"></div>
    </div>
    
    <p class="lyric" id="lyric"></p>
    
    <div class="pad">
      <span class="badge">Officially Engaged</span>
      <h1 data-text="Taylor & Travis">Taylor & Travis</h1>
      <p class="sub">Announced at 12:00 p.m. CST, August 26, 2025</p>
      <p class="copy">A love as bold as <span class="chiefs">Chiefs Red</span>, lit with <span class="showgirl">Showgirl Sparkle</span>. Here's to forever.</p>
      
      <div class="cta">
        <button class="btn" onclick="sendBlessing()">Send Your Love</button>
        <span class="count"><span id="wishesCount">0</span> wishes sent</span>
      </div>
      <p class="wishes-intro">Shower them with love and light</p>
      
      <footer>Created for Swifties and 92%ers to celebrate and send them blessings</footer>
    </div>
  </main>
  
  <!-- API Integration Script -->
  <script>
    // GET/POST functions for /api/blessings
    async function getBlessings() {
      try {
        const response = await fetch('/api/blessings');
        if (!response.ok) {
          throw new Error('Failed to fetch blessings');
        }
        const data = await response.json();
        return data.count || 0;
      } catch (error) {
        console.error('Error fetching blessings:', error);
        return 0;
      }
    }
    
    async function sendBlessing() {
      try {
        const response = await fetch('/api/blessings', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ message: 'Blessing sent' })
        });
        
        if (!response.ok) {
          throw new Error('Failed to send blessing');
        }
        
        const data = await response.json();
        updateWishesCounter(data.count);
        
        // Trigger visual effects
        if (typeof hype === 'function') {
          hype();
        }
        
      } catch (error) {
        console.error('Error sending blessing:', error);
        // Still trigger visual effects even if API fails
        if (typeof hype === 'function') {
          hype();
        }
      }
    }
    
    function updateWishesCounter(count) {
      const wishesCountElement = document.getElementById('wishesCount');
      if (wishesCountElement) {
        wishesCountElement.textContent = count;
      }
    }
    
    // Initialize counter on page load
    window.addEventListener('DOMContentLoaded', async function() {
      const count = await getBlessings();
      updateWishesCounter(count);
      
      // Update counter every 10 seconds
      setInterval(async () => {
        const count = await getBlessings();
        updateWishesCounter(count);
      }, 10000);
    });
  </script>
  
  <script src="effects.js"></script>
</body>
</html>
