<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Engagement Card â€” Taylor & Travis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root{
      --bg:#0f1015; --ink:#ffffff; --muted:#cfd2da; --radius:22px;
      --chiefs-grad:linear-gradient(90deg,#E31837 0%,#FFD166 100%);
      --showgirl-grad:linear-gradient(90deg,#FFB457 0%,#FFD166 50%,#FFA040 100%);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;margin:0;padding:0}
    body{color:var(--ink);background:var(--bg);font-family:ui-serif,Georgia,"Times New Roman",system-ui;display:grid;place-items:center;padding:24px;}
    .card{position:relative;width:min(860px,95vw);border-radius:var(--radius);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.12);box-shadow:0 10px 50px rgba(0,0,0,.55),inset 0 0 0 1px rgba(255,255,255,.05),inset 0 0 30px rgba(255,209,102,.08);overflow:hidden;}
    .hero{position:relative;aspect-ratio:16/9;overflow:hidden;cursor:pointer;display:block;}
    .hero.glow-on #bridgeGlow{opacity:.28}
    .hero.glow-on #innerGlow{opacity:.30}
    .hero.glow-on #archGlow{opacity:.18}
    .hero #bridgeGlow,.hero #innerGlow,.hero #archGlow{transition:opacity .35s ease}
    #backGlow,#archGlow,#bridgeGlow,#innerGlow,#sparkle,#frontHaze{position:absolute;inset:0;display:block;pointer-events:none;}
    #backGlow{z-index:1;mix-blend-mode:screen;}
    #archGlow{z-index:2;mix-blend-mode:screen;}
    #bridgeGlow{z-index:2;mix-blend-mode:screen;}
    #innerGlow{z-index:2;mix-blend-mode:screen;}
    .hero img{position:relative;z-index:4;width:100%;height:100%;object-fit:cover;display:block;filter:saturate(1.05) contrast(1.03);}
    .hero::after{content:"";position:absolute;inset:0;z-index:5;background:radial-gradient(120% 80% at 50% 18%,transparent 48%,rgba(0,0,0,.32)72%,rgba(0,0,0,.56)100%);}
    #sparkle{z-index:6;}
    #frontHaze{z-index:7;opacity:.05;mix-blend-mode:overlay;background:radial-gradient(120% 90% at 50% 60%,rgba(255,255,255,.12),transparent 60%);}
    .pad{text-align:center;padding:clamp(18px,4vw,36px);}
    .badge{display:inline-block;padding:.5rem 1rem;border-radius:999px;background:#ffd166;color:#0b0b0f;font-weight:800;letter-spacing:.2px;box-shadow:0 8px 22px rgba(0,0,0,.35);}
    h1{margin:.75rem 0 0;font-size:clamp(2.4rem,3.2vw+1rem,3.8rem);line-height:1.05;font-weight:900;letter-spacing:.3px;color:#fff;text-shadow:0 2px 18px rgba(0,0,0,.45);transition:all .4s ease;--glow-intensity: 0;}
    h1.glowing{text-shadow:0 2px 18px rgba(0,0,0,.45),0 0 20px rgba(255,209,102,calc(var(--glow-intensity) * 0.3)),0 0 40px rgba(255,209,102,calc(var(--glow-intensity) * 0.2)),0 0 60px rgba(255,209,102,calc(var(--glow-intensity) * 0.1));}
    .sub{margin:.4rem 0 0;color:var(--muted);font-size:1.08rem;font-style:italic;opacity:.95;}
    .copy{margin:1.1rem auto 0;max-width:62ch;font-size:1.22rem;font-weight:500;}
    .chiefs{background:linear-gradient(90deg,#FFD166 0%,#FFD166 40%,#E31837 60%,#E31837 100%);background-size:200% 100%;background-position:0% 50%;-webkit-background-clip:text;background-clip:text;color:transparent;animation:flow 8s linear infinite;}
    .showgirl{background:var(--showgirl-grad);background-size:220% 100%;background-position:0% 50%;-webkit-background-clip:text;background-clip:text;color:transparent;animation:flow 10s linear infinite;}
    @keyframes flow{to{background-position:100% 50%;}}
    .lyric{display:block;margin:0;padding:1rem;font-family:'Segoe Script','Bradley Hand','Comic Sans MS',cursive;font-size:1rem;color:#ffd166;text-align:center;letter-spacing:.2px;text-shadow:0 1px 6px rgba(0,0,0,.55);background:rgba(255,255,255,.02);border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1);overflow:hidden;word-wrap:normal;white-space:nowrap;opacity:0;transition:opacity 0.3s ease;}
    .lyric.show{opacity:1;}
    .cta{margin-top:1.4rem;display:flex;justify-content:center;gap:12px;}
    .btn{appearance:none;border:0;cursor:pointer;padding:12px 18px;border-radius:12px;font-weight:800;color:#0b0b0f;letter-spacing:.2px;background:linear-gradient(135deg,#E31837,#FFD166);box-shadow:0 12px 32px rgba(0,0,0,.35);transition:transform .07s ease,filter .2s ease;}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.06);}
    .count{align-self:center;margin-left:12px;padding:8px 10px;border-radius:10px;background:rgba(255,255,255,.08);color:#ffd166;font-weight:700;letter-spacing:.2px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.12);}
    
    .wishes-intro{color:var(--muted);font-size:1rem;margin:1rem 0;font-style:italic;text-align:center;}
    
    
    footer{text-align:center;color:var(--muted);font-size:.92rem;margin-top:1.2rem;padding-bottom:.6rem;}
  </style>
</head>
<body>
  <main class="card" role="main">
    <div class="hero" id="heroBox">
      <div id="backGlow"></div>
      <div id="archGlow"></div>
      <div id="bridgeGlow"></div>
      <div id="innerGlow"></div>
      <img src="https://storage.googleapis.com/msgsndr/drd1jVTMGEyy4qrJRrjP/media/68af6b4fd7981733c33114d3.webp" alt="Taylor Swift and Travis Kelce engagement photo"/>
      <canvas id="sparkle"></canvas>
      <div id="frontHaze"></div>
    </div>
    
    <p class="lyric" id="lyric"></p>
    
    <div class="pad">
      <span class="badge">Officially Engaged</span>
      <h1 data-text="Taylor & Travis">Taylor & Travis</h1>
      <p class="sub">Announced at 12:00 p.m. CST, August 26, 2025</p>
      <p class="copy">A love as bold as <span class="chiefs">Chiefs Red</span>, lit with <span class="showgirl">Showgirl Sparkle</span>. Here's to forever.</p>
      
      <div class="cta">
        <button class="btn" id="showerBtn">Send Your Love</button>
        <span class="count" id="userCountBadge">Your Wishes Sent: 0</span>
        <span class="count" id="countBadge">Wishes Sent: 0</span>
      </div>
      <p class="wishes-intro">Shower them with love and light</p>
      
      <footer>
        Created for Swifties and 92%ers to celebrate and send them blessings
      </footer>
    </div>
  </main>
  
  <!-- Firebase for sharded global counter -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, doc, getDoc, setDoc, updateDoc, increment, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
    
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCJ7TQ084FpnSkbqNlGeiHUH8_c1z2uicE",
      authDomain: "tayvis-engagement.firebaseapp.com",
      projectId: "tayvis-engagement",
      storageBucket: "tayvis-engagement.firebasestorage.app",
      messagingSenderId: "612968132454",
      appId: "1:612968132454:web:81eb995595d29105a7a2a7",
      measurementId: "G-T111WNF5FP"
    };
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    
    // Sharded counter configuration
    const SHARD_COUNT = 20;
    
    // Initialize shards function
    async function initShards() {
      try {
        for (let i = 0; i < SHARD_COUNT; i++) {
          const shardRef = doc(db, 'engagement_shards', `shard_${i}`);
          const shardSnap = await getDoc(shardRef);
          if (!shardSnap.exists()) {
            await setDoc(shardRef, { count: 0 });
          }
        }
      } catch (error) {
        console.log('Error initializing shards:', error);
      }
    }
    
    // Sharded counter functionality
    window.globalCounter = {
      async getCount() {
        try {
          const shardsRef = collection(db, 'engagement_shards');
          const snapshot = await getDocs(shardsRef);
          let totalCount = 0;
          
          snapshot.forEach(doc => {
            totalCount += doc.data().count || 0;
          });
          
          return totalCount;
        } catch (error) {
          console.log('Error getting count:', error);
          return 0;
        }
      },
      
      async incrementCount() {
        try {
          // Choose a random shard
          const randomShard = Math.floor(Math.random() * SHARD_COUNT);
          const shardRef = doc(db, 'engagement_shards', `shard_${randomShard}`);
          
          await updateDoc(shardRef, {
            count: increment(1)
          });
        } catch (error) {
          console.log('Error incrementing count:', error);
        }
      },
      
      async updateDisplay() {
        const count = await this.getCount();
        const badge = document.getElementById('countBadge');
        if (badge) {
          badge.textContent = `Wishes Sent: ${count.toLocaleString()}`;
        }
      }
    };
    
    // Local storage counter functionality
    function initUserCounter() {
      const userWishes = localStorage.getItem('userWishes') || '0';
      updateUserCountDisplay(parseInt(userWishes));
    }
    
    function updateUserCountDisplay(count) {
      const userBadge = document.getElementById('userCountBadge');
      if (userBadge) {
        userBadge.textContent = `Your Wishes Sent: ${count}`;
      }
    }
    
    function incrementUserCount() {
      const currentCount = parseInt(localStorage.getItem('userWishes') || '0');
      const newCount = currentCount + 1;
      localStorage.setItem('userWishes', newCount.toString());
      updateUserCountDisplay(newCount);
    }
    
    // Button click handler with dual counters
    document.getElementById('showerBtn').addEventListener('click', function() {
      // Increment personal counter instantly
      incrementUserCount();
      
      // Increment global counter
      window.globalCounter.incrementCount();
      
      // Update global display (may take a moment)
      setTimeout(() => {
        window.globalCounter.updateDisplay();
      }, 500);
    });
    
    // Initialize shards on load
    initShards();
    
    // Initialize user counter on load
    initUserCounter();
    
    // Update global display every 5 seconds
    setInterval(() => {
      window.globalCounter.updateDisplay();
    }, 5000);
    
    // Initial load
    window.globalCounter.updateDisplay();
  </script>
  
  <script src="effects.js"></script>
</body>
</html>
